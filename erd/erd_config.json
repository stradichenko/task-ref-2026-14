{
  "title": "Database Schema: DM1 Multi-Modal Dataset",
  "subtitle": "Clinical · Genomic · Proteomic · Governance",
  "domains": {
    "clinical":   { "color": "#4A90D9", "label": "Clinical" },
    "genomic":    { "color": "#00B894", "label": "Genomic" },
    "proteomic":  { "color": "#E17055", "label": "Proteomic" },
    "governance": { "color": "#6C5CE7", "label": "Governance" }
  },
  "tables": [
    {
      "id": "sites",
      "domain": "clinical",
      "label": "sites",
      "columns": [
        { "name": "site_id",       "type": "INTEGER",      "pk": true  },
        { "name": "site_code",     "type": "VARCHAR(20)",  "pk": false },
        { "name": "hospital_name", "type": "VARCHAR(200)", "pk": false },
        { "name": "country",       "type": "VARCHAR(3)",   "pk": false },
        { "name": "region",        "type": "VARCHAR(100)", "pk": false }
      ]
    },
    {
      "id": "personnel",
      "domain": "clinical",
      "label": "personnel",
      "columns": [
        { "name": "personnel_id", "type": "INTEGER",      "pk": true  },
        { "name": "site_id",      "type": "INTEGER",      "pk": false, "fk": "sites.site_id" },
        { "name": "role",         "type": "VARCHAR(50)",  "pk": false },
        { "name": "username",     "type": "VARCHAR(100)", "pk": false },
        { "name": "active_from",  "type": "DATE",         "pk": false },
        { "name": "active_to",    "type": "DATE",         "pk": false }
      ]
    },
    {
      "id": "patients",
      "domain": "clinical",
      "label": "patients",
      "columns": [
        { "name": "patient_id",       "type": "INTEGER",      "pk": true  },
        { "name": "site_id",          "type": "INTEGER",      "pk": false, "fk": "sites.site_id" },
        { "name": "pseudonym",        "type": "VARCHAR(40)",  "pk": false },
        { "name": "date_of_birth",    "type": "DATE",         "pk": false },
        { "name": "sex",              "type": "VARCHAR(10)",  "pk": false },
        { "name": "enrollment_date",  "type": "DATE",         "pk": false },
        { "name": "withdrawal_date",  "type": "DATE",         "pk": false },
        { "name": "ctg_repeat_length","type": "INTEGER",      "pk": false },
        { "name": "age_at_onset",     "type": "NUMERIC(4,1)", "pk": false },
        { "name": "clinical_form",    "type": "VARCHAR(30)",  "pk": false }
      ]
    },
    {
      "id": "visits",
      "domain": "clinical",
      "label": "visits",
      "columns": [
        { "name": "visit_id",      "type": "INTEGER",      "pk": true  },
        { "name": "patient_id",    "type": "INTEGER",      "pk": false, "fk": "patients.patient_id" },
        { "name": "site_id",       "type": "INTEGER",      "pk": false, "fk": "sites.site_id" },
        { "name": "personnel_id",  "type": "INTEGER",      "pk": false, "fk": "personnel.personnel_id" },
        { "name": "visit_type",    "type": "VARCHAR(30)",  "pk": false },
        { "name": "scheduled_date","type": "DATE",         "pk": false },
        { "name": "actual_date",   "type": "DATE",         "pk": false },
        { "name": "visit_status",  "type": "VARCHAR(20)",  "pk": false }
      ]
    },
    {
      "id": "diagnoses",
      "domain": "clinical",
      "label": "diagnoses",
      "columns": [
        { "name": "diagnosis_id",    "type": "INTEGER",      "pk": true  },
        { "name": "patient_id",      "type": "INTEGER",      "pk": false, "fk": "patients.patient_id" },
        { "name": "visit_id",        "type": "INTEGER",      "pk": false, "fk": "visits.visit_id" },
        { "name": "icd10_code",      "type": "VARCHAR(10)",  "pk": false },
        { "name": "snomed_concept",  "type": "BIGINT",       "pk": false },
        { "name": "description",     "type": "TEXT",         "pk": false },
        { "name": "onset_date",      "type": "DATE",         "pk": false },
        { "name": "diagnosis_status","type": "VARCHAR(20)",  "pk": false }
      ]
    },
    {
      "id": "medications",
      "domain": "clinical",
      "label": "medications",
      "columns": [
        { "name": "medication_id",  "type": "INTEGER",      "pk": true  },
        { "name": "patient_id",     "type": "INTEGER",      "pk": false, "fk": "patients.patient_id" },
        { "name": "visit_id",       "type": "INTEGER",      "pk": false, "fk": "visits.visit_id" },
        { "name": "atc_code",       "type": "VARCHAR(10)",  "pk": false },
        { "name": "drug_name",      "type": "VARCHAR(200)", "pk": false },
        { "name": "dose",           "type": "NUMERIC(10,2)","pk": false },
        { "name": "dose_unit",      "type": "VARCHAR(20)",  "pk": false },
        { "name": "start_date",     "type": "DATE",         "pk": false },
        { "name": "end_date",       "type": "DATE",         "pk": false }
      ]
    },
    {
      "id": "adverse_events",
      "domain": "clinical",
      "label": "adverse_events",
      "columns": [
        { "name": "ae_id",         "type": "INTEGER",      "pk": true  },
        { "name": "patient_id",    "type": "INTEGER",      "pk": false, "fk": "patients.patient_id" },
        { "name": "visit_id",      "type": "INTEGER",      "pk": false, "fk": "visits.visit_id" },
        { "name": "reported_by",   "type": "INTEGER",      "pk": false, "fk": "personnel.personnel_id" },
        { "name": "ae_term",       "type": "VARCHAR(200)", "pk": false },
        { "name": "severity",      "type": "VARCHAR(20)",  "pk": false },
        { "name": "serious",       "type": "BOOLEAN",      "pk": false },
        { "name": "onset_date",    "type": "DATE",         "pk": false },
        { "name": "resolution_date","type": "DATE",        "pk": false },
        { "name": "outcome",       "type": "VARCHAR(50)",  "pk": false }
      ]
    },
    {
      "id": "epro_responses",
      "domain": "clinical",
      "label": "epro_responses",
      "columns": [
        { "name": "response_id",      "type": "INTEGER",      "pk": true  },
        { "name": "patient_id",       "type": "INTEGER",      "pk": false, "fk": "patients.patient_id" },
        { "name": "visit_id",         "type": "INTEGER",      "pk": false, "fk": "visits.visit_id" },
        { "name": "instrument_code",  "type": "VARCHAR(50)",  "pk": false },
        { "name": "instrument_version","type": "VARCHAR(10)", "pk": false },
        { "name": "item_code",        "type": "VARCHAR(50)",  "pk": false },
        { "name": "loinc_code",       "type": "VARCHAR(20)",  "pk": false },
        { "name": "value_numeric",    "type": "NUMERIC(10,3)","pk": false },
        { "name": "value_text",       "type": "TEXT",         "pk": false },
        { "name": "collected_ts",     "type": "TIMESTAMPTZ",  "pk": false }
      ]
    },
    {
      "id": "lab_results",
      "domain": "clinical",
      "label": "lab_results",
      "columns": [
        { "name": "lab_result_id",  "type": "INTEGER",      "pk": true  },
        { "name": "patient_id",     "type": "INTEGER",      "pk": false, "fk": "patients.patient_id" },
        { "name": "visit_id",       "type": "INTEGER",      "pk": false, "fk": "visits.visit_id" },
        { "name": "loinc_code",     "type": "VARCHAR(20)",  "pk": false },
        { "name": "test_name",      "type": "VARCHAR(200)", "pk": false },
        { "name": "value_numeric",  "type": "NUMERIC(12,4)","pk": false },
        { "name": "unit",           "type": "VARCHAR(30)",  "pk": false },
        { "name": "reference_low",  "type": "NUMERIC(12,4)","pk": false },
        { "name": "reference_high", "type": "NUMERIC(12,4)","pk": false },
        { "name": "collected_date", "type": "DATE",         "pk": false }
      ]
    },
    {
      "id": "genomic_samples",
      "domain": "genomic",
      "label": "genomic_samples",
      "columns": [
        { "name": "gsample_id",      "type": "INTEGER",      "pk": true  },
        { "name": "patient_id",      "type": "INTEGER",      "pk": false, "fk": "patients.patient_id" },
        { "name": "site_id",         "type": "INTEGER",      "pk": false, "fk": "sites.site_id" },
        { "name": "sample_barcode",  "type": "VARCHAR(40)",  "pk": false },
        { "name": "sample_type",     "type": "VARCHAR(30)",  "pk": false },
        { "name": "collection_date", "type": "DATE",         "pk": false },
        { "name": "qc_status",       "type": "VARCHAR(10)",  "pk": false }
      ]
    },
    {
      "id": "genomic_libraries",
      "domain": "genomic",
      "label": "genomic_libraries",
      "columns": [
        { "name": "library_id",      "type": "INTEGER",      "pk": true  },
        { "name": "gsample_id",      "type": "INTEGER",      "pk": false, "fk": "genomic_samples.gsample_id" },
        { "name": "library_prep",    "type": "VARCHAR(50)",  "pk": false },
        { "name": "platform",        "type": "VARCHAR(50)",  "pk": false },
        { "name": "read_length",     "type": "INTEGER",      "pk": false },
        { "name": "mean_coverage",   "type": "NUMERIC(8,2)", "pk": false },
        { "name": "run_date",        "type": "DATE",         "pk": false },
        { "name": "qc_status",       "type": "VARCHAR(10)",  "pk": false }
      ]
    },
    {
      "id": "variants",
      "domain": "genomic",
      "label": "variants",
      "columns": [
        { "name": "variant_id",      "type": "BIGINT",       "pk": true  },
        { "name": "library_id",      "type": "INTEGER",      "pk": false, "fk": "genomic_libraries.library_id" },
        { "name": "chromosome",      "type": "VARCHAR(5)",   "pk": false },
        { "name": "position",        "type": "INTEGER",      "pk": false },
        { "name": "ref_allele",      "type": "TEXT",         "pk": false },
        { "name": "alt_allele",      "type": "TEXT",         "pk": false },
        { "name": "rs_id",           "type": "VARCHAR(20)",  "pk": false },
        { "name": "hgvs",            "type": "TEXT",         "pk": false },
        { "name": "gene_symbol",     "type": "VARCHAR(30)",  "pk": false },
        { "name": "consequence",     "type": "VARCHAR(50)",  "pk": false },
        { "name": "quality",         "type": "NUMERIC(8,2)", "pk": false },
        { "name": "filter_status",   "type": "VARCHAR(10)",  "pk": false }
      ]
    },
    {
      "id": "proteomic_samples",
      "domain": "proteomic",
      "label": "proteomic_samples",
      "columns": [
        { "name": "psample_id",      "type": "INTEGER",      "pk": true  },
        { "name": "patient_id",      "type": "INTEGER",      "pk": false, "fk": "patients.patient_id" },
        { "name": "site_id",         "type": "INTEGER",      "pk": false, "fk": "sites.site_id" },
        { "name": "sample_barcode",  "type": "VARCHAR(40)",  "pk": false },
        { "name": "sample_type",     "type": "VARCHAR(30)",  "pk": false },
        { "name": "collection_date", "type": "DATE",         "pk": false },
        { "name": "qc_status",       "type": "VARCHAR(10)",  "pk": false }
      ]
    },
    {
      "id": "proteomic_runs",
      "domain": "proteomic",
      "label": "proteomic_runs",
      "columns": [
        { "name": "run_id",          "type": "INTEGER",      "pk": true  },
        { "name": "psample_id",      "type": "INTEGER",      "pk": false, "fk": "proteomic_samples.psample_id" },
        { "name": "instrument",      "type": "VARCHAR(100)", "pk": false },
        { "name": "method",          "type": "VARCHAR(100)", "pk": false },
        { "name": "run_date",        "type": "DATE",         "pk": false },
        { "name": "normalization",   "type": "VARCHAR(50)",  "pk": false },
        { "name": "qc_status",       "type": "VARCHAR(10)",  "pk": false }
      ]
    },
    {
      "id": "protein_quantifications",
      "domain": "proteomic",
      "label": "protein_quantifications",
      "columns": [
        { "name": "quant_id",        "type": "BIGINT",       "pk": true  },
        { "name": "run_id",          "type": "INTEGER",      "pk": false, "fk": "proteomic_runs.run_id" },
        { "name": "uniprot_accession","type": "VARCHAR(20)", "pk": false },
        { "name": "gene_symbol",     "type": "VARCHAR(30)",  "pk": false },
        { "name": "protein_name",    "type": "VARCHAR(200)", "pk": false },
        { "name": "intensity",       "type": "NUMERIC(18,4)","pk": false },
        { "name": "log2_intensity",  "type": "NUMERIC(10,4)","pk": false },
        { "name": "peptide_count",   "type": "INTEGER",      "pk": false },
        { "name": "qc_flag",         "type": "VARCHAR(10)",  "pk": false }
      ]
    },
    {
      "id": "consent_records",
      "domain": "governance",
      "label": "consent_records",
      "columns": [
        { "name": "consent_id",      "type": "INTEGER",      "pk": true  },
        { "name": "patient_id",      "type": "INTEGER",      "pk": false, "fk": "patients.patient_id" },
        { "name": "consent_version", "type": "VARCHAR(20)",  "pk": false },
        { "name": "consent_scope",   "type": "VARCHAR(50)",  "pk": false },
        { "name": "granted_ts",      "type": "TIMESTAMPTZ",  "pk": false },
        { "name": "withdrawn_ts",    "type": "TIMESTAMPTZ",  "pk": false }
      ]
    },
    {
      "id": "audit_trail",
      "domain": "governance",
      "label": "audit_trail",
      "columns": [
        { "name": "audit_id",      "type": "BIGINT",       "pk": true  },
        { "name": "table_name",    "type": "VARCHAR(60)",  "pk": false },
        { "name": "record_id",     "type": "BIGINT",       "pk": false },
        { "name": "personnel_id",  "type": "INTEGER",      "pk": false, "fk": "personnel.personnel_id" },
        { "name": "action",        "type": "VARCHAR(20)",  "pk": false },
        { "name": "old_value",     "type": "JSONB",        "pk": false },
        { "name": "new_value",     "type": "JSONB",        "pk": false },
        { "name": "reason",        "type": "TEXT",         "pk": false },
        { "name": "event_ts",      "type": "TIMESTAMPTZ",  "pk": false },
        { "name": "ip_address",    "type": "INET",         "pk": false }
      ]
    },
    {
      "id": "data_queries",
      "domain": "governance",
      "label": "data_queries",
      "columns": [
        { "name": "query_id",      "type": "INTEGER",      "pk": true  },
        { "name": "patient_id",    "type": "INTEGER",      "pk": false, "fk": "patients.patient_id" },
        { "name": "site_id",       "type": "INTEGER",      "pk": false, "fk": "sites.site_id" },
        { "name": "domain",        "type": "VARCHAR(20)",  "pk": false },
        { "name": "table_name",    "type": "VARCHAR(60)",  "pk": false },
        { "name": "record_id",     "type": "BIGINT",       "pk": false },
        { "name": "description",   "type": "TEXT",         "pk": false },
        { "name": "severity",      "type": "VARCHAR(10)",  "pk": false },
        { "name": "status",        "type": "VARCHAR(20)",  "pk": false },
        { "name": "assigned_to",   "type": "INTEGER",      "pk": false, "fk": "personnel.personnel_id" },
        { "name": "opened_ts",     "type": "TIMESTAMPTZ",  "pk": false },
        { "name": "resolved_ts",   "type": "TIMESTAMPTZ",  "pk": false }
      ]
    }
  ],
  "relationships": [
    { "from": "personnel.site_id",                     "to": "sites.site_id",                         "cardinality": "N:1" },
    { "from": "patients.site_id",                      "to": "sites.site_id",                         "cardinality": "N:1" },
    { "from": "visits.patient_id",                     "to": "patients.patient_id",                   "cardinality": "N:1" },
    { "from": "visits.site_id",                        "to": "sites.site_id",                         "cardinality": "N:1" },
    { "from": "visits.personnel_id",                   "to": "personnel.personnel_id",                "cardinality": "N:1" },
    { "from": "diagnoses.patient_id",                  "to": "patients.patient_id",                   "cardinality": "N:1" },
    { "from": "diagnoses.visit_id",                    "to": "visits.visit_id",                       "cardinality": "N:1" },
    { "from": "medications.patient_id",                "to": "patients.patient_id",                   "cardinality": "N:1" },
    { "from": "medications.visit_id",                  "to": "visits.visit_id",                       "cardinality": "N:1" },
    { "from": "adverse_events.patient_id",             "to": "patients.patient_id",                   "cardinality": "N:1" },
    { "from": "adverse_events.visit_id",               "to": "visits.visit_id",                       "cardinality": "N:1" },
    { "from": "adverse_events.reported_by",            "to": "personnel.personnel_id",                "cardinality": "N:1" },
    { "from": "epro_responses.patient_id",             "to": "patients.patient_id",                   "cardinality": "N:1" },
    { "from": "epro_responses.visit_id",               "to": "visits.visit_id",                       "cardinality": "N:1" },
    { "from": "lab_results.patient_id",                "to": "patients.patient_id",                   "cardinality": "N:1" },
    { "from": "lab_results.visit_id",                  "to": "visits.visit_id",                       "cardinality": "N:1" },
    { "from": "genomic_samples.patient_id",            "to": "patients.patient_id",                   "cardinality": "N:1" },
    { "from": "genomic_samples.site_id",               "to": "sites.site_id",                         "cardinality": "N:1" },
    { "from": "genomic_libraries.gsample_id",          "to": "genomic_samples.gsample_id",            "cardinality": "N:1" },
    { "from": "variants.library_id",                   "to": "genomic_libraries.library_id",          "cardinality": "N:1" },
    { "from": "proteomic_samples.patient_id",          "to": "patients.patient_id",                   "cardinality": "N:1" },
    { "from": "proteomic_samples.site_id",             "to": "sites.site_id",                         "cardinality": "N:1" },
    { "from": "proteomic_runs.psample_id",             "to": "proteomic_samples.psample_id",          "cardinality": "N:1" },
    { "from": "protein_quantifications.run_id",        "to": "proteomic_runs.run_id",                 "cardinality": "N:1" },
    { "from": "consent_records.patient_id",            "to": "patients.patient_id",                   "cardinality": "N:1" },
    { "from": "audit_trail.personnel_id",              "to": "personnel.personnel_id",                "cardinality": "N:1" },
    { "from": "data_queries.patient_id",               "to": "patients.patient_id",                   "cardinality": "N:1" },
    { "from": "data_queries.site_id",                  "to": "sites.site_id",                         "cardinality": "N:1" },
    { "from": "data_queries.assigned_to",              "to": "personnel.personnel_id",                "cardinality": "N:1" }
  ]
}
